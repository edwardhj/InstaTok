# TravelTok API Documentation

Listed below are all the endpoints of the backend for TravelTok

## User Authentication/Authorization

### All endpoints that require authentication

All endpoints that require a current user to be logged in.

- Request: endpoints that require authentication
- Error Response: Require authentication

  - Status Code: 401
  - Headers:
    - Content-Type: application/json
  - Body:

  ```json
  {
  	"message": "Authentication required"
  }
  ```

### All endpoints that require proper authorization

All endpoints that require authentication and the current user does not have the correct role(s) or permission(s).

- Request: endpoints that require proper authorization
- Error Response: Require proper authorization

  - Status Code: 403
  - Headers:
    - Content-Type: application/json
  - Body:

    ```json
    {
    	"message": "Forbidden"
    }
    ```

### Get the Current User

Returns the information about the current user that is logged in.

- Require Authentication: false
- Request

  - Method: GET
  - URL: /api/auth
  - Body: none

- Successful Response when there is a logged in user

  - Status Code: 200
  - Headers:
    - Content-Type: application/json
  - Body:

    ```json
    {
    	"id": 1,
    	"first_name": "John",
      "last_name": "Smith",
    	"email": "johnsmith@gmail.com",
      "username": "thejohnsmith",
      "isAdmin": false,
      "profile_pic": "aws_link_to_profile_pic"
    }
    ```

* Error Response when there is no logged in user

  - Status Code: 401
  - Headers:
    - Content-Type: application/json
  - Body:

    ```json
    {
    	"error": "No user is logged in"
    }
    ```

### Log In a User

Logs in a current user with valid credentials and returns the current user's
information.

- Require Authentication: false
- Request

  - Method: POST
  - URL: /api/auth/login
  - Headers:
    - Content-Type: application/json
  - Body:

    ```json
    {
    	"email": "johnsmith@gmail.com",
    	"password": "password"
    }
    ```

* Successful Response

  - Status Code: 200
  - Headers:
    - Content-Type: application/json
  - Body:

    ```json
    {
    	"id": 1,
    	"first_name": "John",
      "last_name": "Smith",
    	"email": "johnsmith@gmail.com",
      "username": "thejohnsmith",
      "isAdmin": false,
      "profile_pic": "aws_link_to_profile_pic"
    }
    ```

* Error Response: Invalid credentials

  - Status Code: 401
  - Headers:
    - Content-Type: application/json
  - Body:

    ```json
    {
    	"message": "Invalid credentials"
    }
    ```

* Error response: Body validation errors

  - Status Code: 400
  - Headers:
    - Content-Type: application/json
  - Body:

    ```json
    {
    	"message": "Bad Request", // (or "Validation error" if generated by wtforms),
    	"errors": {
    		"email": ["This field is required"],
    		"password": ["This field is required"]
    	}
    }
    ```

### Sign Up a User

Creates a new user, logs them in as the current user, and returns the current
user's information.

- Require Authentication: false
- Request

  - Method: POST
  - URL: /api/auth/signup
  - Headers:
    - Content-Type: application/json
  - Body:

    ```json
    {
    	"first_name": "John",
      "last_name": "Smith",
    	"email": "johnsmith@gmail.com",
      "username": "thejohnsmith",
      "password": "password",
      "isAdmin": false,
      "profile_pic": "profile picture file"
    }
    ```

* Successful Response

  - Status Code: 200
  - Headers:
    - Content-Type: application/json
  - Body:

    ```json
    {
    	"id": 1,
    	"first_name": "John",
      "last_name": "Smith",
    	"email": "johnsmith@gmail.com",
      "username": "thejohnsmith",
      "isAdmin": false,
      "profile_pic": "aws_link_to_profile_pic"
    }
    ```

* Error response: User already exists with the specified email

  - Status Code: 500
  - Headers:
    - Content-Type: application/json
  - Body:

    ```json
    {
    	"message": "User already exists",
    	"errors": {
    		"email": "Email address is already in use"
    	}
    }
    ```

* Error response: User already exists with the specified username

  - Status Code: 500
  - Headers:
    - Content-Type: application/json
  - Body:

    ```json
    {
    	"message": "User already exists",
    	"errors": {
    		"username": "Username is already in use"
    	}
    }
    ```

* Error response: Body validation errors

  - Status Code: 400
  - Headers:
    - Content-Type: application/json
  - Body:
    ```json
    {
    	"message": "Bad Request", // (or "Validation error" if generated by wtforms),
    	"errors": {
    		"email": "Invalid email",
    		"first_name": "First Name is required",
        "last_name": "Last Name is required",
        "password": "Password is required"
    	}
    }
    ```


## Likes

### Get all likes by track_id

Returns an object containing all likes by track_id

- Require Authentication: false
- Require Authorization: false

* Request:

  - Method: GET
  - URL: /api/likes/:trackId
  - Headers:
    - Content-Type: application/json
  - Body: None

* Successful Response:

```json
{
		{
      "likes": <number of likes>
		}
}
```
* Error response: Couldn't find a track with the specified id

- Status Code: 404
- Headers:
- Content-Type: application/json
- Body:

  ```json
    "message": "Track couldn't be found"
  ```

### Get all liked tracks by current user

Returns an object containing all tracks liked by user

- Require Authentication: true
- Require Authorization: true

* Request:
  - Method: GET
  - URL: /api/likes
  - Headers:
    - Content-Type: application/json
  - Body: None
* Successful Response:

```json
[
	{
		"trackId": 1,
		"name": "track one",
		"duration": 180,
		"file": "path/to/file",
		"artistId": 1,
		"albumId": 1,
	},
	{
		"trackId": 2,
		"name": "track two",
		"duration": 180,
		"file": "path/to/file",
		"artistId": 1,
		"albumId": 1,
	}
]
```

### Create a like (like a song)

Returns an object containing the track liked

- Require Authentication: true
- Require Authorization: false

* Request:
  - Method: POST
  - URL: /api/likes/:trackId
  - Headers:
    - Content-Type: application/json
  - Body:
  ```json
  {
    "userID": <logged in user id>
    "trackId": <track Id> 
  }
  ```
* Successful Response:
  ```json
  {
  	"message": "You have successfully liked the track"
  }
  ```
- Error Response:
- Status Code: 404
  - Headers:
    - Content-Type: application/json

```json
{
	"message": "Track couldn't be found"
}
```

### Delete a like
Deletes a like for a track

- Require Authentication: true
- Require Authorization: true

* Request:
  - Method: DELETE
  - URL: /api/likes/:trackId
  - Headers:
    - Content-Type: application/json
  - Body: None
* Successful Response:

```json
{
	"message": "Successfully Deleted Like"
}
```
- Error Response:
- Status Code: 404
  - Headers:
    - Content-Type: application/json

```json
{
	"message": "Like couldn't be found"
}
```